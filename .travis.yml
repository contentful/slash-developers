language: node_js
dist: trusty
sudo: required

node_js: 5.1
ruby: 2.2.3

before_install:
  - sudo apt-get install jq
  - sudo apt-get install hunspell
  - make -C apiary install

script:
  - make -C apiary test
  - ./spelling.sh
  - npm run-script write-good-main; exit 0
  - npm run-script write-good-apiary; exit 0

cache:
  directories:
    - apiary/node_modules
    - node_modules

deploy:
  provider: script
  script: make -C apiary publish
  skip_cleanup: true
  on:
    branch: master

notifications:
  slack: contentful:o4vrtCfCCvlN0ebhJ3ypu2je
  on_success: always
  on_failure: always
